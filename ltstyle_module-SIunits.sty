%\RequirePackage[squaren,Gray,thickqspace]{SIunits}
\RequirePackage{sistyle} %TODO check compat
\SIobeyboldtrue
\RequirePackage{numprint}
\def\SIcdot{{\fontfamily{cmr}\cdot}}
\def\usk{\SIcdot}
\def\usp{\,}
\makeatletter
\@ifpackagewith{babel}{french}{
\def\mydecimalsign{,}
\def\mythousandsep{\,}
}{
\def\mydecimalsign{.}
\def\mythousandsep{,}
}
\@ifpackageloaded{polyglossia}
                 {\AtBeginDocument{
                     \iflanguage{french}
                                {
                                  \def\mydecimalsign{,}
                                  \def\mythousandsep{\,}
                                }
                                {
                                  \def\mydecimalsign{.}
                                  \def\mythousandsep{,}
                                }
                   }
                 }
                 {}
\makeatother
\def\myproductsign{\!\times\!}
\def\myunitsep{\usp}
\def\myunitdot{\usk}
\SIdecimalsign{\mydecimalsign}
\SIthousandsep{\mythousandsep}
\SIproductsign{\myproductsign}
\SIunitsep{\myunitsep}
\SIunitdot{\myunitdot}
\SIunitspace{\myunitdot}
\npdecimalsign{\mydecimalsign}
\npthousandsep{\mythousandsep}
\npproductsign{\myproductsign}
\npunitseparator{\myunitsep}
\def\unit{\SI}
\makeatletter
\def\SIunskip{}
\newlength{\myunitsepwidth}
\let\origSI\SI
\def\emptytest{}
\def\SI#1#2{{\protect \settowidth{\myunitsepwidth}{\myunitsep}\def\emptytest{#1}\ifx\emptytest\empty\else \def\SIunskip{\hspace*{-\myunitsepwidth}}\fi\ensuremath{\origSI{#1}{#2}}}}
\makeatletter
\@ifclassloaded{beamer}{
  \renewcommand{\SIupmath}[2][]{#2}
  \let\ltstyleSI\SI
  \def\SI#1#2{\ltstyleSI{#1}{\rm #2}}
  \DeclareRobustCommand{\addunit}[2]{\newcommand{#1}{\ensuremath{\rm #2}}}
  \DeclareRobustCommand{\addprefix}[2]{\newcommand{#1}{\ensuremath{\rm #2}}}
}{
  \DeclareRobustCommand{\addunit}[2]{\newcommand{#1}{{\SIunitfamily #2}}}
  \DeclareRobustCommand{\addprefix}[2]{\newcommand{#1}{{\SIunitfamily #2}}}
  }
\makeatother
%\makeatletter
%\@ifpackagewith{babel}{french}{\renewcommand{\degre}{\degree}}{\newcommand{\degre}{\degree}}%{\ensuremath{^\circ}}
%\makeatother
\DeclareTextSymbolDefault{\SImu}{TS1}
\DeclareTextSymbol{\SImu}{TS1}{181}
\addprefix{\yocto}{y}
\addprefix{\zepto}{z}
\addprefix{\atto}{a}
\addprefix{\femto}{f}
\addprefix{\pico}{p}
\addprefix{\nano}{n}
\addprefix{\micro}{\mbox{\SImu}}
\addprefix{\milli}{m}
\addprefix{\centi}{c}
\addprefix{\deci}{d}
\addprefix{\deca}{da}
\addprefix{\hecto}{h}
\addprefix{\kilo}{k}
\addprefix{\mega}{M}
\addprefix{\giga}{G}
\addprefix{\tera}{T}
\addprefix{\peta}{P}
\addprefix{\exa}{E}
\addprefix{\zetta}{Z}
\addprefix{\yotta}{Y}
\def\yoctod{\ensuremath{10^{-24}}}
\def\zeptod{\ensuremath{10^{-21}}}
\def\attod{\ensuremath{10^{-18}}}
\def\femtod{\ensuremath{10^{-15}}}
\def\picod{\ensuremath{10^{-12}}}
\def\nanod{\ensuremath{10^{-9}}}
\def\microd{\ensuremath{10^{-6}}}
\def\millid{\ensuremath{10^{-3}}}
\def\centid{\ensuremath{10^{-2}}}
\def\decid{\ensuremath{10^{-1}}}
\def\decad{\ensuremath{10^{1}}}
\def\hectod{\ensuremath{10^{2}}}
\def\kilod{\ensuremath{10^{3}}}
\def\megad{\ensuremath{10^{6}}}
\def\gigad{\ensuremath{10^{9}}}
\def\terad{\ensuremath{10^{12}}}
\def\petad{\ensuremath{10^{15}}}
\def\exad{\ensuremath{10^{18}}}
\def\zettad{\ensuremath{10^{21}}}
\def\yottad{\ensuremath{10^{24}}}
\addunit{\gram}{g}
\addunit{\metre}{m}
\def\meter{\metre}
\addunit{\kilogram}{\kilo\gram}
\addunit{\second}{s}
\addunit{\ampere}{A}
\addunit{\kelvin}{K}
\addunit{\mole}{mol}
\addunit{\candela}{cd}
\addunit{\radian}{rad}
\addunit{\steradian}{sr}
\addunit{\hertz}{Hz}
\addunit{\newton}{N}
\addunit{\pascal}{Pa}
\addunit{\joule}{J}
\addunit{\watt}{W}
\addunit{\coulomb}{C}
\addunit{\volt}{V}
\addunit{\farad}{F}
\addunit{\siemens}{S}
\addunit{\weber}{Wb}
\addunit{\tesla}{T}
\addunit{\henry}{H}
\AtBeginDocument{
\let\origarcdeg\arcdeg
\renewcommand{\arcdeg}{\textrm{\SIunskip\origarcdeg}}
\addunit{\degree}{\SIunskip\origarcdeg}
\addunit{\arcminute}{\SIunskip\ensuremath{'}}
%\def\paminute{\arcminute}
%\def\pamin{\arcminute}
\def\arcmin{\arcminute}
\addunit{\arcsecond}{\SIunskip\ensuremath{''}}
%\def\pasecond{\arcsecond}
%\def\pasec{\arcsecond}
\def\arcsec{\arcsecond}
}
\def\degre{\degree}
\def\degC{\origarcdeg\textrm{C}}
\def\degF{\origarcdeg\textrm{F}}
\addunit{\lumen}{lm}
\addunit{\lux}{lx}
\addunit{\becquerel}{Bq}
\addunit{\Gray}{Gy}
\addunit{\sievert}{Sv}
\addunit{\katal}{kat}
\addunit{\minute}{min}
\addunit{\hour}{h}
\addunit{\dday}{d}
\addunit{\ton}{t}
\addunit{\tonne}{t}
\addunit{\liter}{L}
\addunit{\litre}{l}
\addunit{\neper}{Np}
\addunit{\bel}{B}
\addunit{\curie}{Ci}
\addunit{\rad}{rad}
\addunit{\arad}{rd}
\addunit{\rem}{rem}
\addunit{\roentgen}{R}
\addunit{\electronvolt}{e\volt}
\addunit{\eV}{\electronvolt}
\addunit{\keV}{\kilo\eV}
\addunit{\MeV}{\mega\eV}
\addunit{\GeV}{\giga\eV}
\addunit{\TeV}{\tera\eV}
\def\clumunit{\text{$c$}}
\def\hbarunit{\text{$\hbar$}}
\addunit{\atomicmass}{u}
\addunit{\atomicmassunit}{u}
\addunit{\astronomicunit}{ua}
\addunit{\dalton}{Da}
\addunit{\are}{a}
\addunit{\hectare}{\hecto\are}
\addunit{\barn}{b}
\addunit{\bbar}{bar}
\addunit{\atmosphere}{atm}
\addunit{\gal}{Gal}
\addunit{\angstrom}{\mbox{{\AA}}}
\def\litre{\liter}
\def\debye{D}
\addunit{\gauss}{G}
\addunit{\parsec}{pc}
\addunit{\jansky}{Jy}
\addunit{\dyne}{dyn}
\addunit{\anneelum}{\text{a.-l.}}
\addunit{\calorie}{cal}
\addunit{\erg}{erg}
\addunit{\poise}{P}
\addunit{\stokes}{St}
\addunit{\stilb}{sb}
\addunit{\phot}{ph}
\addunit{\maxwell}{Mx}
\addunit{\oersted}{Oe}

\def\dimL{\textsf{L}}
\def\dimM{\textsf{M}}
\def\dimT{\textsf{T}}
\def\dimN{\textsf{N}}
%\makeatletter
%\@ifclassloaded{beamer}{\def\dimtemp{\ensuremath{\Theta}}}{\def\dimtemp{\ensuremath{\mathsf{\Theta}}}}
%\makeatother
\def\dimtemp{\ensuremath{\mathsf{\Theta}}}
\def\dimI{\textsf{I}}
\def\dimJ{\textsf{J}}
