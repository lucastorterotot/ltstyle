\RequirePackage{siunitx}
\AtBeginDocument{\RenewCommandCopy\qty\SI} % compat with physics
\AtBeginDocument{% backwards compat
    \def\SI#1#2{\qty{#1}{#2}}
    \def\U#1{\unit{#1}}
}
\ifLuaTeX
    \def\SIcdot{\text{\setmainfont{CMU Serif}\hspace{-.23em}\cdot\hspace{-.23em}}}
\else
    \def\SIcdot{{\fontfamily{cmr}\cdot}}
\fi
\def\usk{\SIcdot}
\def\usp{\,}
\makeatletter
\@ifpackagewith{babel}{french}{
\sisetup{locale = FR}
\def\mydecimalsign{,}
\def\mythousandsep{\,}
\def\myintervalsep{;}
}{
\def\mydecimalsign{.}
\def\mythousandsep{,}
\def\myintervalsep{,}
}
\@ifpackageloaded{polyglossia}
                 {
                   \AtBeginDocument{
                     \iflanguage{french}{\sisetup{locale = FR}}{}
                     \def\mydecimalsign{\iflanguage{french}{,}{.}}
                     \def\mythousandsep{\iflanguage{french}{\,}{,}}
                     \def\myintervalsep{\iflanguage{french}{;}{,}}
                   }
                 }
                 {}
\makeatother
\def\isp{\myintervalsep}
\def\myproductsign{\!\times\!}
\sisetup{
    exponent-product = \myproductsign,
    inter-unit-product = \SIcdot,
    mode = match,
    propagate-math-font = true,
    reset-math-version = false,
    input-digits = 0123456789\pi,
}
\def\myunitsep{\usp}
\def\myunitdot{\usk}
\def\qtyu#1#2#3{\ensuremath{(\num{#1}\pm\num{#2})\usp\U{#3}}}
\def\qtyuu#1#2#3#4{\ensuremath{\num{#1}{}^{+\num{#2}}_{-\num{#3}}\usp\U{#4}}}
\DeclareTextSymbolDefault{\unitmu}{TS1}
\DeclareTextSymbol{\unitmu}{TS1}{181}
\def\quecto{\ensuremath{\mathrm{q}}}
\DeclareSIPrefix\quecto{q}{-30}
\def\ronto{\ensuremath{\mathrm{r}}}
\DeclareSIPrefix\ronto{r}{-27}
\def\yocto{\ensuremath{\mathrm{y}}}
\DeclareSIPrefix\yocto{y}{-24}
\def\zepto{\ensuremath{\mathrm{z}}}
\DeclareSIPrefix\zepto{z}{-21}
\def\atto{\ensuremath{\mathrm{a}}}
\DeclareSIPrefix\atto{a}{-18}
\def\femto{\ensuremath{\mathrm{f}}}
\DeclareSIPrefix\femto{f}{-15}
\def\pico{\ensuremath{\mathrm{p}}}
\DeclareSIPrefix\pico{p}{-12}
\def\nano{\ensuremath{\mathrm{n}}}
\DeclareSIPrefix\nano{n}{-9}
\def\micro{\mbox{\unitmu}}
\DeclareSIPrefix\micro{\mbox{\unitmu}}{-6}
\def\milli{\ensuremath{\mathrm{m}}}
\DeclareSIPrefix\milli{m}{-3}
\def\centi{\ensuremath{\mathrm{c}}}
\DeclareSIPrefix\centi{c}{-2}
\def\deci{\ensuremath{\mathrm{d}}}
\DeclareSIPrefix\deci{d}{-1}
\def\deca{\ensuremath{\mathrm{da}}}
\DeclareSIPrefix\deca{da}{1}
\def\hecto{\ensuremath{\mathrm{h}}}
\DeclareSIPrefix\hecto{h}{2}
\def\kilo{\ensuremath{\mathrm{k}}}
\DeclareSIPrefix\kilo{k}{3}
\def\mega{\ensuremath{\mathrm{M}}}
\DeclareSIPrefix\mega{M}{6}
\def\giga{\ensuremath{\mathrm{G}}}
\DeclareSIPrefix\giga{G}{9}
\def\tera{\ensuremath{\mathrm{T}}}
\DeclareSIPrefix\tera{T}{12}
\def\peta{\ensuremath{\mathrm{P}}}
\DeclareSIPrefix\peta{P}{15}
\def\exa{\ensuremath{\mathrm{E}}}
\DeclareSIPrefix\exa{E}{18}
\def\zetta{\ensuremath{\mathrm{Z}}}
\DeclareSIPrefix\zetta{Z}{21}
\def\yotta{\ensuremath{\mathrm{Y}}}
\DeclareSIPrefix\yotta{Y}{24}
\def\ronna{\ensuremath{\mathrm{R}}}
\DeclareSIPrefix\ronna{R}{27}
\def\quetta{\ensuremath{\mathrm{Q}}}
\DeclareSIPrefix\quetta{Q}{30}
\def\quectod{\ensuremath{10^{-30}}}
\def\rontod{\ensuremath{10^{-27}}}
\def\yoctod{\ensuremath{10^{-24}}}
\def\zeptod{\ensuremath{10^{-21}}}
\def\attod{\ensuremath{10^{-18}}}
\def\femtod{\ensuremath{10^{-15}}}
\def\picod{\ensuremath{10^{-12}}}
\def\nanod{\ensuremath{10^{-9}}}
\def\microd{\ensuremath{10^{-6}}}
\def\millid{\ensuremath{10^{-3}}}
\def\centid{\ensuremath{10^{-2}}}
\def\decid{\ensuremath{10^{-1}}}
\def\decad{\ensuremath{10^{1}}}
\def\hectod{\ensuremath{10^{2}}}
\def\kilod{\ensuremath{10^{3}}}
\def\megad{\ensuremath{10^{6}}}
\def\gigad{\ensuremath{10^{9}}}
\def\terad{\ensuremath{10^{12}}}
\def\petad{\ensuremath{10^{15}}}
\def\exad{\ensuremath{10^{18}}}
\def\zettad{\ensuremath{10^{21}}}
\def\yottad{\ensuremath{10^{24}}}
\def\ronnad{\ensuremath{10^{27}}}
\def\quettad{\ensuremath{10^{30}}}

\DeclareSIUnit{\Wh}{Wh}
\DeclareSIUnit{\tour}{tr}
\AtBeginDocument{
\ifx \arcdeg \undefined \def\arcdeg{\ensuremath{{}^{\circ}}}\fi
\DeclareSIUnit[quantity-product = {}]\degree{\arcdeg}
\def\degre{\degree}
\DeclareSIUnit[quantity-product = {}]\arcminute{\ensuremath{'}}
\def\arcmin{\arcminute}
\DeclareSIUnit[quantity-product = {}]\arcsecond{\ensuremath{''}}
\def\arcsec{\arcsecond}
}
\DeclareSIUnit\degC{\ensuremath{{}^{\circ}}C}
\DeclareSIUnit\degF{\ensuremath{{}^{\circ}}F}

\DeclareSIUnit{\Gray}{Gy}
\DeclareSIUnit{\dday}{d}
\DeclareSIUnit{\curie}{Ci}
\DeclareSIUnit{\rad}{rad}
\DeclareSIUnit{\arad}{rd}
\DeclareSIUnit{\rem}{rem}
\DeclareSIUnit{\roentgen}{R}
\DeclareSIUnit{\clumunit}{\ensuremath{\it c}}
\DeclareSIUnit{\hbarunit}{\ensuremath{\hbar}}
\DeclareSIUnit{\astronomicunit}{ua}
\DeclareSIUnit{\are}{a}
\DeclareSIUnit{\bbar}{bar}
\DeclareSIUnit{\atmosphere}{atm}
\DeclareSIUnit{\mmHg}{mm\,\ce{Hg}}
\DeclareSIUnit{\gal}{Gal}
\DeclareSIUnit{\angstrom}{\mbox{{\AA}}}
\DeclareSIUnit{\debye}{D}
\DeclareSIUnit{\gauss}{G}
\DeclareSIUnit{\parsec}{pc}
\DeclareSIUnit{\jansky}{Jy}
\DeclareSIUnit{\dyne}{dyn}
\DeclareSIUnit{\anneelum}{{a.l.}}
\DeclareSIUnit{\calorie}{cal}
\DeclareSIUnit{\erg}{erg}
\DeclareSIUnit{\poise}{P}
\DeclareSIUnit{\poiseuille}{Pl}
\DeclareSIUnit{\stokes}{St}
\DeclareSIUnit{\stilb}{sb}
\DeclareSIUnit{\phot}{ph}
\DeclareSIUnit{\maxwell}{Mx}
\DeclareSIUnit{\oersted}{Oe}
\def\uVA{VA}
\DeclareSIUnit{\voltampere}{\uVA}
\DeclareSIUnit{\VA}{\uVA}
\def\uVAR{\uVA R}
\DeclareSIUnit{\voltamperereactif}{\uVAR}
\DeclareSIUnit{\VAR}{\uVAR}
\def\uVAD{\uVA D}
\DeclareSIUnit{\voltamperedeformant}{\uVAD}
\DeclareSIUnit{\VAD}{\uVAD}

\def\dimL{\text{\rm\origsffamily L}}
\def\dimM{\text{\rm\origsffamily M}}
\def\dimT{\text{\rm\origsffamily T}}
\def\dimN{\text{\rm\origsffamily N}}
%\makeatletter
%\@ifclassloaded{beamer}{\def\dimtemp{\ensuremath{\Theta}}}{\def\dimtemp{\ensuremath{\mathsf{\Theta}}}}
%\makeatother
\def\dimtemp{\ensuremath{\mathsf{\Theta}}}
\def\dimI{\text{\rm\origsffamily I}}
\def\dimJ{\text{\rm\origsffamily J}}
