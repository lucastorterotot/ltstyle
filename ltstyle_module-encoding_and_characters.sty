\ifLuaTeX
  \RequirePackage[no-math]{fontspec}
  \setmainfont{CMU Serif}[
    SlantedFont = LMRomanSlant12-Regular,
    SlantedFeatures={
      LetterSpace=-1,
      WordSpace={.9},
      SizeFeatures={
        {Size={-8.4},Font=LMRomanSlant8-Regular},
        {Size={8.4-9.4},Font=LMRomanSlant9-Regular},
        {Size={9.4-10.9},Font=LMRomanSlant10-Regular},
        {Size={10.9-14.4},Font=LMRomanSlant12-Regular},
        {Size={14.4-},Font=LMRomanSlant17-Regular},
      }
    }
  ]
  \usepackage[utf8]{luainputenc}
\else
  \RequirePackage[T1]{fontenc} % Output font encoding for international characters % codage moderne des caractères sous Latex
  \RequirePackage[utf8]{inputenc} % Required for inputting international characters
  \RequirePackage{lmodern} %better characters
  \rmfamily \normalfont %to load T1lmr.fd 
  \DeclareFontShape{T1}{lmr}{bx}{sc}{<->sub*cmr/bx/sc}{}
\fi

\makeatletter
\@ifpackageloaded{babel}{}{
  \@ifpackageloaded{polyglossia}{}{
    \ifLuaTeX
      \RequirePackage{polyglossia}
      \setdefaultlanguage{french}
      \AtBeginDocument{\def\og{«~}\def\fg{\unskip »}}
    \else
      \RequirePackage[french]{babel}
    \fi
  }
}
\@ifpackageloaded{babel}{
  \@ifpackagewith{babel}{french}{}{\def\og{"}\def\fg{\unskip "}}
}{
  \def\og{"}\def\fg{\unskip "}
}
\makeatother
\def\frenchfigurename{Figure}
\def\frenchtablename{Tableau}
\ifLuaTeX
  \gappto\captionsfrench{\renewcommand{\figurename}{\frenchfigurename}}
  \gappto\captionsfrench{\renewcommand{\tablename}{\frenchtablename}}
\fi

\RequirePackage{microtype} \emergencystretch=.5em % Improves character and word spacing

\RequirePackage{bold-extra} %meilleure gestion du gras

\RequirePackage{marvosym}
\let\origEUR\EUR \def\EUR{\text{\origEUR}} \def\€{\EUR} \def\euro{\EUR}
\def\sun{\ensuremath{\odot}}
\AtEndPreamble{\AtBeginDocument{
\let\origsun\sun
\def\sun{\ensuremath{\odot}}
}}
\let\origSun\Sun
\def\Sun{\text{\origSun}}

\RequirePackage{pifont}

%\RequirePackage{fix-cm}	 % Custom font sizes - used for the initial letter in the document

\RequirePackage{multicol} % Used for the columns
