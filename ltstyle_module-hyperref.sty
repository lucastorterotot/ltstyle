\makeatletter
\@ifclassloaded{beamer}{}{
\@ifpackageloaded{hyperref}{}{
\definecolor{linkcolor}{rgb}{0,0,.6}
\RequirePackage[colorlinks=true,pdfstartview=FitV,linkcolor= linkcolor,citecolor= linkcolor,urlcolor= linkcolor,hyperindex=true,hyperfigures=false,hypertexnames=false]{hyperref}}

\AtEndPreamble{\AtBeginDocument{
  \makeatletter
  \ifx\@title\empty \def\pdftitle{\TitleToUse} \else \def\pdftitle{\@title}\fi
  \hypersetup{pdfauthor={\insertauthor},pdftitle={\pdftitle},pdfsubject={\insertmatiere}}
  \makeatother
  \ifthenelse{\equal{\ltcolortheme}{red}}
             {\hypersetup{linkcolor=Firebrick3, citecolor=Firebrick3, urlcolor=Firebrick3}}
             {}
  \ifthenelse{\equal{\ltcolortheme}{orange}}
             {\hypersetup{linkcolor=Goldenrod3, citecolor=Goldenrod3, urlcolor=Goldenrod3}}
             {}
  \ifthenelse{\equal{\ltcolortheme}{green}}
             {\hypersetup{linkcolor=DarkOliveGreen4, citecolor=DarkOliveGreen4, urlcolor=DarkOliveGreen4}}
             {}
  \ifthenelse{\equal{\ltcolortheme}{cyan}}
             {\hypersetup{linkcolor=DeepSkyBlue4, citecolor=DeepSkyBlue4, urlcolor=DeepSkyBlue4}}
             {}
  \ifthenelse{\equal{\ltcolortheme}{blue}}
             {\hypersetup{linkcolor=DeepSkyBlue4, citecolor=DeepSkyBlue4, urlcolor=DeepSkyBlue4}}
             {}
  \ifthenelse{\equal{\ltcolortheme}{violet}}
             {\hypersetup{linkcolor=DarkOrchid3, citecolor=DarkOrchid3, urlcolor=DarkOrchid3}}
             {}
  \ifthenelse{\equal{\ltcolortheme}{magenta}}
             {\hypersetup{linkcolor=DeepPink3, citecolor=DeepPink3, urlcolor=DeepPink3}}
             {}
}}

}
\makeatother

\newcommand{\mailto}[1]{\href{mailto:#1}{\texttt{#1}}}
